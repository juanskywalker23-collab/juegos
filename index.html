<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>MONSE NITRO EDITION üöÄ</title>
  <style>
    body { background: #000; color: white; font-family: 'Courier New', monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; touch-action: manipulation; }
    h1 { color: #ff4da6; text-shadow: 0 0 15px #ff4da6; margin: 10px 0; font-size: 24px; }
    canvas { border: 3px solid #ff4da6; display: none; background: #000; max-width: 95vw; max-height: 50vh; touch-action: none; box-shadow: 0 0 20px #ff4da6; }
    #hud { margin-top: 5px; display: none; font-size: 18px; color: #ff4da6; text-align: center; font-weight: bold; }
    .btn { background: none; border: 2px solid #ff4da6; color: white; padding: 12px 24px; font-family: inherit; cursor: pointer; border-radius: 8px; font-size: 18px; transition: 0.3s; margin: 5px; }
    #controls { display: none; grid-template-columns: repeat(3, 75px); gap: 12px; margin-top: 15px; }
    .tbtn { width: 75px; height: 75px; background: rgba(255, 77, 166, 0.4); border: 3px solid #ff4da6; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; user-select: none; -webkit-tap-highlight-color: transparent; }
    #gameOverOverlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 100; }
  </style>
</head>
<body>

  <div id="gameOverOverlay">
    <h2 style="color:#ff4da6; font-size:50px;">GAME OVER</h2>
    <p style="color:pink; font-size:28px;">TE AMO MONSE ‚ù§Ô∏è</p>
    <button class="btn" onclick="location.reload()">REINTENTAR</button>
  </div>

  <h1>TE AMO MONSE ‚ù§Ô∏è üöÄ</h1>

  <div id="menu">
    <button class="btn" onclick="initMaze()">1. Laberinto ü•ï</button>
    <button class="btn" onclick="initFlappy()">2. MODO NITRO ‚ö°</button>
  </div>

  <div id="hud">Pts: <span id="score">0</span> | ‚ù§Ô∏è: <span id="lives">3</span></div>
  
  <canvas id="gameCanvas" width="600" height="600"></canvas>

  <div id="controls">
    <div></div><div class="tbtn" id="btnUp">‚Üë</div><div></div>
    <div class="tbtn" id="btnLeft">‚Üê</div><div class="tbtn" id="btnDown">‚Üì</div><div class="tbtn" id="btnRight">‚Üí</div>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas'), ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score'), livesEl = document.getElementById('lives'), controls = document.getElementById('controls');
    
    let score = 0, lives = 3, gameActive = true, currentMode = '', frame = 0;
    let player = { x: 1, y: 1, dx: 0, dy: 0, last: 0 };
    // --- FISICAS SUPER NITRO ---
    let bird = { y: 300, dy: 0, gravity: 0.55, jump: -9.5 }; 
    let pipes = [], flappyStarted = false;

    const mazeLayout = ["1111111111111111111111111","1000000000110000000000001","1011111110110111111111101","1010000010000001000000101","1010111011111111011100101","1010001000000000010000101","1011101110111111011110101","1000100000100000010000100","1110111111101111110110111","1000000000001000000000001","1011111111111011111111101","1010000000000010000000101","1010111111111110111110101","1010000000000000000000101","1011111011111111111011101","1000001000000000001000001","1111101111110111110111111","1000000000010000000000001","1011111111011111111111101","1010000000010000000000101","1010111111111111111100101","1010000000000000000000101","1011111111110111111111101","1000000000000000000000001","1111111111111111111111111"].map(r => r.split('').map(Number));

    function setDir(x, y) { player.dx = x; player.dy = y; }

    document.getElementById('btnUp').ontouchstart = (e) => { e.preventDefault(); setDir(0, -1); };
    document.getElementById('btnDown').ontouchstart = (e) => { e.preventDefault(); setDir(0, 1); };
    document.getElementById('btnLeft').ontouchstart = (e) => { e.preventDefault(); setDir(-1, 0); };
    document.getElementById('btnRight').ontouchstart = (e) => { e.preventDefault(); setDir(1, 0); };

    function initMaze() {
      currentMode = 'MAZE';
      document.getElementById('menu').style.display = 'none';
      canvas.style.display = 'block';
      document.getElementById('hud').style.display = 'block';
      controls.style.display = 'grid';
      run();
    }

    function initFlappy() {
      currentMode = 'FLAPPY';
      document.getElementById('menu').style.display = 'none';
      canvas.style.display = 'block';
      document.getElementById('hud').style.display = 'block';
      const jumpAction = (e) => { 
        if(gameActive) { flappyStarted = true; bird.dy = bird.jump; if(e.cancelable) e.preventDefault(); }
      };
      canvas.ontouchstart = jumpAction;
      canvas.onmousedown = jumpAction;
      run();
    }

    function run() {
      if(!gameActive) return;
      ctx.clearRect(0,0,600,600);
      if(currentMode==='MAZE') {
        if(Date.now() - player.last > 120) {
          if(mazeLayout[player.y+player.dy]?.[player.x+player.dx]===0) { player.x+=player.dx; player.y+=player.dy; }
          player.last = Date.now();
        }
        ctx.strokeStyle = '#ff4da6';
        for(let y=0;y<25;y++) for(let x=0;x<25;x++) if(mazeLayout[y][x]) ctx.strokeRect(x*24,y*24,24,24);
        ctx.font = '22px Arial'; ctx.fillText('üê∞', player.x*24+2, player.y*24+20);
      } else {
        if(flappyStarted) {
          bird.dy += bird.gravity; bird.y += bird.dy;
          if(frame++ % 50 === 0) pipes.push({x:600, h: Math.random()*250+120, counted: false});
          pipes.forEach(p => {
            p.x -= 9.0; // VELOCIDAD EXTREMA
            ctx.fillStyle = '#ff4da6';
            ctx.fillRect(p.x, 0, 50, p.h-90); ctx.fillRect(p.x, p.h+90, 50, 600);
            if(p.x<90 && p.x>10 && (bird.y<p.h-85 || bird.y>p.h+75)) { lives--; livesEl.innerText=lives; bird.y=300; bird.dy=0; if(lives<=0) die(); }
            if(!p.counted && p.x<40) { score++; scoreEl.innerText=score; p.counted=true; }
          });
          pipes = pipes.filter(p => p.x > -60);
          if(bird.y>600 || bird.y<0) { lives--; livesEl.innerText=lives; bird.y=300; bird.dy=0; if(lives<=0) die(); }
        } else {
          ctx.fillStyle="white"; ctx.font="30px Courier New"; ctx.fillText("TOCA PARA NITRO", 170, 300);
        }
        ctx.font='45px Arial'; ctx.fillText('üê∞', 40, bird.y);
      }
      requestAnimationFrame(run);
    }

    function die() { gameActive = false; document.getElementById('gameOverOverlay').style.display = 'flex'; }
  </script>
</body>
</html>